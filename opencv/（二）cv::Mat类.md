
## 1. cv::Mat类
> `cv::Mat`类是用于保存图像以及其他矩阵数据的数据结构。  
> 默认尺寸为0，也可以指定初试尺寸：`cv::Mat image(240,320,CV_8U,cv::Scalar(100));`   
> `CV_8U`中，`8`指的是8位，即一个字节，`U`指的是无符号Unsigned,也可以用`S`声明为带符号的Signed类型。  
> 对于彩色图像，需要指定3个通道，即`CV_8UC3`。  
> 对于16位，32位的整数图像，`CV_16SC3`。  
> 还可以声明32位，64位的浮点数，`CV_32F`。  
> 当cv::Mat对象离开作用域后，分配的内存将自动释放，避免内存泄漏。

## 2. 拷贝
> cv::Mat实现了引用计数及浅拷贝。当图像之间赋值时，图像数据并没有发生复制，两个对象都指向同一块内存块。可用于参数传值的图像，以及返回值传值的图像。  
> 引用计数的作用是，只有当所有引用内存数据的对象都被析构后，才会释放内存块。

```
cv::Mat image2,image3;
image2=result;  //两个图拥有同一份数据

result.copyTo(image3);  //创建新的拷贝
```
> 如果希望创建的图像拥有原始图像的崭新拷贝，可使用`copyTo()`方法。

编写返回图像和函数或类的方法
```
cv::Mat func(){
  cv::Mat image(240,320,CV_8U,cv::Scalar(100));
  return image;
}
```
在main函数中调用该函数
```
cv::Mat gray=func();  //得到灰度图。
```
gray变量中包含函数中创建的图像内容，而不涉及额外的内存分配。  
函数返回的cv::Mat对象在转移到gray时仅发生浅拷贝。函数中声明的局部变量image在离开作用域时被析构，但是由于它所关联的引用计数表示内部图像正被另一个对象gray所引用，因此，内存块并不会被释放。
